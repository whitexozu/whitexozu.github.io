{"componentChunkName":"component---src-templates-blog-template-js","path":"/2020-03-26-language-python-macro-find-image/","result":{"data":{"cur":{"id":"040195a9-ffda-50d2-9d3c-0e21c9a9e914","html":"<p>사내메신저로 MS Temas를 쓰는데 모든 채팅방을 공유하라는 지시가 내려왔습니다.<br />\n윗분 칭찬한 내용들이 많은데 보여드리면 어색해 질까봐 다 지우려고 합니다.<br />\n팀즈는 방파 기능이 없는거 같아 채팅 내용을 하나하나 지우는 메크로를 만들었습니다.<br />\n<br />\n순서는 간단합니다.<br /></p>\n<h2 id=\"순서\" style=\"position:relative;\"><a href=\"#%EC%88%9C%EC%84%9C\" aria-label=\"순서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>순서</h2>\n<ol>\n<li>커서를 이동시켜 본인 채팅내용 찾기</li>\n<li>채팅내용에 마우스 오버시 나오는 옵션 버튼 클릭</li>\n<li>옵션 버튼 클릭시 생기는 삭제 버튼 클릭</li>\n</ol>\n<h2 id=\"환경\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD\" aria-label=\"환경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>환경</h2>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">OS</span><span class=\"token punctuation\">:</span> MacOS Catalina 10.15.3\n<span class=\"token key atrule\">Python</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3.5</span>\n<span class=\"token key atrule\">pyautogui</span><span class=\"token punctuation\">:</span> 0.9.48\n<span class=\"token key atrule\">mss</span><span class=\"token punctuation\">:</span> 5.0.0\n<span class=\"token key atrule\">cv2</span><span class=\"token punctuation\">:</span> 4.1.1.26\n<span class=\"token key atrule\">pyobjc-framework-Quartz</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5.3</span>\n<span class=\"token key atrule\">numpy</span><span class=\"token punctuation\">:</span> 1.18.1</code></pre></div>\n<h2 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h2>\n<h3 id=\"pyaotugui-설치\" style=\"position:relative;\"><a href=\"#pyaotugui-%EC%84%A4%EC%B9%98\" aria-label=\"pyaotugui 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pyaotugui 설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> pyaotugui</code></pre></div>\n<h3 id=\"pyobjc-framework-quartz-설치\" style=\"position:relative;\"><a href=\"#pyobjc-framework-quartz-%EC%84%A4%EC%B9%98\" aria-label=\"pyobjc framework quartz 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pyobjc-framework-Quartz 설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> pyobjc-framework-Quartz</code></pre></div>\n<h3 id=\"스크린샷-패키지-mss-설치\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7-%ED%8C%A8%ED%82%A4%EC%A7%80-mss-%EC%84%A4%EC%B9%98\" aria-label=\"스크린샷 패키지 mss 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스크린샷 패키지 mss 설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> mss</code></pre></div>\n<h3 id=\"opencv-python-설치\" style=\"position:relative;\"><a href=\"#opencv-python-%EC%84%A4%EC%B9%98\" aria-label=\"opencv python 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>opencv-python 설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> opencv-python<span class=\"token operator\">==</span><span class=\"token number\">4.1</span>.1.26</code></pre></div>\n<h3 id=\"numpy\" style=\"position:relative;\"><a href=\"#numpy\" aria-label=\"numpy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>numpy</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> numpuy</code></pre></div>\n<h2 id=\"주요-기능\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5\" aria-label=\"주요 기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 기능</h2>\n<h3 id=\"마우스-이동-및-클릭-스크롤\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%9A%B0%EC%8A%A4-%EC%9D%B4%EB%8F%99-%EB%B0%8F-%ED%81%B4%EB%A6%AD-%EC%8A%A4%ED%81%AC%EB%A1%A4\" aria-label=\"마우스 이동 및 클릭 스크롤 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마우스 이동 및 클릭, 스크롤</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># position 확인</span>\nx<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> pag<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nposition_str <span class=\"token operator\">=</span> <span class=\"token string\">'X : '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">' Y : '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>position_str<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 이동</span>\npag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 클릭</span>\npag<span class=\"token punctuation\">.</span>mouseDown<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\npag<span class=\"token punctuation\">.</span>mouseUp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 스크롤</span>\npag<span class=\"token punctuation\">.</span>scroll<span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>직관적인 내용들 입니다. 아쉬운 부분은 스크롤을 미세하게 할 수 없습니다. 보다 다양한 기능은 참고사이트를 확인 바랍니다.</li>\n</ul>\n<h3 id=\"이미지-캡처-후-출력\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%BA%A1%EC%B2%98-%ED%9B%84-%EC%B6%9C%EB%A0%A5\" aria-label=\"이미지 캡처 후 출력 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지 캡처 후 출력</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> mss<span class=\"token punctuation\">.</span>mss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sct<span class=\"token punctuation\">:</span>\n    point_button_img_pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">}</span>\n    point_button_img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sct<span class=\"token punctuation\">.</span>grab<span class=\"token punctuation\">(</span>point_button_img_pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n    cv2<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span><span class=\"token string\">'point_button_img'</span><span class=\"token punctuation\">,</span> point_button_img<span class=\"token punctuation\">)</span>\n    cv2<span class=\"token punctuation\">.</span>waitKey<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>포지션 정보의 이미지를 캡처하고 cv2를 이용하여 윈도우 창으로 출력합니다. 버튼의 위치를 찾는데 사용합니다.</li>\n</ul>\n<h3 id=\"캡처된-이미지-rgb값-확인\" style=\"position:relative;\"><a href=\"#%EC%BA%A1%EC%B2%98%EB%90%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-rgb%EA%B0%92-%ED%99%95%EC%9D%B8\" aria-label=\"캡처된 이미지 rgb값 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>캡처된 이미지 RGB값 확인</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mean <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[0]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[1]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[2]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>이미지를 캡처해도 이미지를 비교 할 수 없죠. 그래서 이미지의 평균 RGB값을 이용해서 비슷한 값이면 같은 이미지라고 판단합니다.</li>\n<li>어쩌다 색감이 비슷한 영역을 캡처 하게되면 버튼이 아닌데 버튼으로 인식할 수도 있는 오류가 많이 발생되는 부분이기도 합니다.</li>\n<li>태마가 바뀌면 값을 모두 다시 세팅해 줘야 하는 문제도 생길수 있겠네요.</li>\n</ul>\n<h2 id=\"전체-소스\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EC%B2%B4-%EC%86%8C%EC%8A%A4\" aria-label=\"전체 소스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전체 소스</h2>\n<p>제 소스보단 참고 사이트의 <em>빵형의 개발도상국 - 집행검키우기</em>의 유투브 시청을 추천 드립니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pyautogui <span class=\"token keyword\">as</span> pag\n<span class=\"token keyword\">import</span> mss<span class=\"token punctuation\">,</span> cv2\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token comment\"># delay after click</span>\npag<span class=\"token punctuation\">.</span>PAUSE <span class=\"token operator\">=</span> <span class=\"token number\">0.08</span>\ncoord_mouse <span class=\"token operator\">=</span> <span class=\"token number\">13</span>\nwait_time <span class=\"token operator\">=</span> <span class=\"token number\">0.2</span>\n\n<span class=\"token comment\"># icon position</span>\npoint_init <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">657</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">928</span><span class=\"token punctuation\">}</span>\npoint_top <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">}</span>\nchat_purple <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">640</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">920</span><span class=\"token punctuation\">}</span>\npoint_button <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">}</span>\nup_delete_button <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">176</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">}</span>\ndown_delete_button <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">94</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">15</span><span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">compute_point_icon_type</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mean <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># print('point mean[0]: ' + str(mean[0]))</span>\n    <span class=\"token comment\"># print('point mean[1]: ' + str(mean[1]))</span>\n    <span class=\"token comment\"># print('point mean[2]: ' + str(mean[2]))</span>\n\n    <span class=\"token keyword\">if</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">244</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">250</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">244</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">250</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">244</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">250</span><span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> <span class=\"token string\">'ICON'</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> <span class=\"token string\">'OTHER'</span>\n\n    <span class=\"token keyword\">return</span> result\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">compute_delete_icon_type</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mean <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[0]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[1]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'delete mean[2]: '</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">209</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">211</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">209</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">211</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">210</span> <span class=\"token keyword\">and</span> mean<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">212</span><span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> <span class=\"token string\">'ICON'</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> <span class=\"token string\">'OTHER'</span>\n\n    <span class=\"token keyword\">return</span> result\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">click</span><span class=\"token punctuation\">(</span>coords<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    pag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>coords<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>coords<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> duration<span class=\"token operator\">=</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span>wait_time<span class=\"token punctuation\">)</span>\n    pag<span class=\"token punctuation\">.</span>mouseDown<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    pag<span class=\"token punctuation\">.</span>mouseUp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">mouse_move_scroll</span><span class=\"token punctuation\">(</span>coords<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    pag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span>coords<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> coord_mouse<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> coords<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">15</span> <span class=\"token operator\">&lt;</span> point_top<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        pag<span class=\"token punctuation\">.</span>scroll<span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span>\n        pag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span>chat_purple<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> chat_purple<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 앱 활성화</span>\n    pag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span>point_init<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> point_init<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    pag<span class=\"token punctuation\">.</span>mouseDown<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    pag<span class=\"token punctuation\">.</span>mouseUp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    pag<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span>chat_purple<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> chat_purple<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n\n    <span class=\"token comment\"># while True:</span>\n    <span class=\"token comment\">#     x, y = pag.position()</span>\n    <span class=\"token comment\">#     position_str = 'X : ' + str(x) + ' Y : ' + str(y)</span>\n    <span class=\"token comment\">#     print(position_str)</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n\n        <span class=\"token comment\"># point icon 이미지 캡쳐</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span>wait_time<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">with</span> mss<span class=\"token punctuation\">.</span>mss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sct<span class=\"token punctuation\">:</span>\n            x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> pag<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            point_button_img_pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n            point_button_img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sct<span class=\"token punctuation\">.</span>grab<span class=\"token punctuation\">(</span>point_button_img_pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n            long_point_icon_type <span class=\"token operator\">=</span> compute_point_icon_type<span class=\"token punctuation\">(</span>point_button_img<span class=\"token punctuation\">)</span>\n\n            point_button_img_pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n            point_button_img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sct<span class=\"token punctuation\">.</span>grab<span class=\"token punctuation\">(</span>point_button_img_pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n            short_point_icon_type <span class=\"token operator\">=</span> compute_point_icon_type<span class=\"token punctuation\">(</span>point_button_img<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># cv2.imshow('point_button', point_button_img)</span>\n            <span class=\"token comment\"># cv2.waitKey(0)</span>\n\n            plus_top <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n            <span class=\"token keyword\">if</span> short_point_icon_type <span class=\"token operator\">==</span> <span class=\"token string\">'ICON'</span><span class=\"token punctuation\">:</span>\n                plus_top <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n\n            <span class=\"token keyword\">if</span> long_point_icon_type <span class=\"token operator\">==</span> <span class=\"token string\">'ICON'</span> <span class=\"token keyword\">or</span> short_point_icon_type <span class=\"token operator\">==</span> <span class=\"token string\">'ICON'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'icon click'</span><span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># cv2.imshow('point_button', point_button_img)</span>\n                <span class=\"token comment\"># cv2.waitKey(0)</span>\n\n                <span class=\"token comment\"># move point button</span>\n                <span class=\"token comment\"># click point button</span>\n                click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> plus_top<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n                time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span>wait_time<span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># delete icon 이미지 캡쳐</span>\n                up_delete_button_pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> up_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> up_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> plus_top<span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> up_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> up_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n                up_delete_button_img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sct<span class=\"token punctuation\">.</span>grab<span class=\"token punctuation\">(</span>up_delete_button_pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n                up_delete_icon_type <span class=\"token operator\">=</span> compute_delete_icon_type<span class=\"token punctuation\">(</span>up_delete_button_img<span class=\"token punctuation\">)</span>\n\n                <span class=\"token keyword\">if</span> up_delete_icon_type <span class=\"token operator\">==</span> <span class=\"token string\">'ICON'</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'up delete icon click'</span><span class=\"token punctuation\">)</span>\n\n                    <span class=\"token comment\"># move delete button</span>\n                    <span class=\"token comment\"># click delete button</span>\n                    click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> up_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> plus_top<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n                down_delete_button_pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> down_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">:</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> down_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> plus_top<span class=\"token punctuation\">,</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> down_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> down_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n                down_delete_button_img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>sct<span class=\"token punctuation\">.</span>grab<span class=\"token punctuation\">(</span>down_delete_button_pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n                down_delete_icon_type <span class=\"token operator\">=</span> compute_delete_icon_type<span class=\"token punctuation\">(</span>down_delete_button_img<span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># cv2.imshow('up_delete_button_img', up_delete_button_img)</span>\n                <span class=\"token comment\"># cv2.imshow('down_delete_button_img', down_delete_button_img)</span>\n                <span class=\"token comment\"># cv2.waitKey(0)</span>\n\n                <span class=\"token keyword\">if</span> down_delete_icon_type <span class=\"token operator\">==</span> <span class=\"token string\">'ICON'</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'down delete icon click'</span><span class=\"token punctuation\">)</span>\n\n                    <span class=\"token comment\"># move delete button</span>\n                    <span class=\"token comment\"># click delete button</span>\n                    click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> point_button<span class=\"token punctuation\">[</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> down_delete_button<span class=\"token punctuation\">[</span><span class=\"token string\">'top'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> plus_top<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># move mouse &amp; scroll</span>\n                mouse_move_scroll<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'move mouse'</span><span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># move mouse &amp; scroll</span>\n                mouse_move_scroll<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"참고-사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고 사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고 사이트</h2>\n<ul>\n<li>빵형의 개발도상국 - 집행검키우기: <a href=\"https://www.youtube.com/watch?v=1jePlDVw2rQ\">https://www.youtube.com/watch?v=1jePlDVw2rQ</a></li>\n<li>pyautogui: <a href=\"https://pyautogui.readthedocs.io/en/latest/\">https://pyautogui.readthedocs.io/en/latest/</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%88%9C%EC%84%9C\">순서</a></li>\n<li><a href=\"#%ED%99%98%EA%B2%BD\">환경</a></li>\n<li>\n<p><a href=\"#%EC%84%A4%EC%B9%98\">설치</a></p>\n<ul>\n<li><a href=\"#pyaotugui-%EC%84%A4%EC%B9%98\">pyaotugui 설치</a></li>\n<li><a href=\"#pyobjc-framework-quartz-%EC%84%A4%EC%B9%98\">pyobjc-framework-Quartz 설치</a></li>\n<li><a href=\"#%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7-%ED%8C%A8%ED%82%A4%EC%A7%80-mss-%EC%84%A4%EC%B9%98\">스크린샷 패키지 mss 설치</a></li>\n<li><a href=\"#opencv-python-%EC%84%A4%EC%B9%98\">opencv-python 설치</a></li>\n<li><a href=\"#numpy\">numpy</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5\">주요 기능</a></p>\n<ul>\n<li><a href=\"#%EB%A7%88%EC%9A%B0%EC%8A%A4-%EC%9D%B4%EB%8F%99-%EB%B0%8F-%ED%81%B4%EB%A6%AD-%EC%8A%A4%ED%81%AC%EB%A1%A4\">마우스 이동 및 클릭, 스크롤</a></li>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%BA%A1%EC%B2%98-%ED%9B%84-%EC%B6%9C%EB%A0%A5\">이미지 캡처 후 출력</a></li>\n<li><a href=\"#%EC%BA%A1%EC%B2%98%EB%90%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-rgb%EA%B0%92-%ED%99%95%EC%9D%B8\">캡처된 이미지 RGB값 확인</a></li>\n</ul>\n</li>\n<li><a href=\"#%EC%A0%84%EC%B2%B4-%EC%86%8C%EC%8A%A4\">전체 소스</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고 사이트</a></li>\n</ul>\n</div>","excerpt":"사내메신저로 MS Temas를 쓰는데 모든 채팅방을 공유하라는 지시가 내려왔습니다.\n윗분 칭찬한 내용들이 많은데 보여드리면 어색해 질까봐 다 지우려고 합니다.\n팀즈는 방파 기능이 없는거 같아 채팅 내용을 하나하나 지우는 메크로를 만들었습니다.\n\n순서는 간단합니다. 순서 커서를 이동시켜 본인 채팅내용 찾기 채팅내용에 마우스 오버시 나오는 옵션 버튼 클릭 옵션 버튼 클릭시 생기는 삭제 버튼 클릭 환경 설치 pyaotugui 설치 pyobjc-framework-Quartz 설치 스크린샷 패키지 mss 설치 opencv-python 설치 numpy 주요 기능 마우스 이동 및 클릭, 스크롤 직관적인 내용들 입니다. 아쉬운 부분은 스크롤을 미세하게 할 수 없습니다. 보다 다양한 기능은 참고사이트를 확인 바랍니다. 이미지 캡처 후 출력 포지션 정보의 이미지를 캡처하고 cv2를 이용하여 윈도우 창으로 출력합니다. 버튼의 위치를 찾는데 사용합니다. 캡처된 이미지 RGB값 확인 이미지를 캡처해도 이…","frontmatter":{"date":"March 26, 2020","title":"[Python] 이미지를 판단 후 자동 실행하는 메크로","categories":"language","author":"TMM","emoji":null},"fields":{"slug":"/2020-03-26-language-python-macro-find-image/"}},"next":{"id":"6dd97ccb-57e8-597b-ab0a-91d6b2d468b9","html":"<p>이미지를 택스트로 변경 할 수 있는 테슬렉트를 설치후 실행해 보겠습니다.</p>\n<h2 id=\"환경\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD\" aria-label=\"환경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>환경</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">OS : MacOS Catalina 10.15.3\nTesseract : 4.1.1\nPython: 3.5\npytesseract: 0.3.3</code></pre></div>\n<h2 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h2>\n<h3 id=\"tesseract-설치\" style=\"position:relative;\"><a href=\"#tesseract-%EC%84%A4%EC%B9%98\" aria-label=\"tesseract 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tesseract 설치</h3>\n<ul>\n<li>\n<p>테서렉트를 활용하기 위해서는 테서렉트 먼저 설치해야합니다. <br />\nhomebrew를 통해서 설치가 가능하며 파이선은 pip를 통해서 pytesseract를 설치하면 설치된 테서렉트를 랩핑하여 사용하는 방식입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ brew <span class=\"token function\">install</span> tesseract\n\n$ brew <span class=\"token function\">install</span> tesseract-lang\n\n$ tesseract --version\ntesseract <span class=\"token number\">4.1</span>.1\nleptonica-1.79.0\nlibgif <span class=\"token number\">5.2</span>.1 <span class=\"token builtin class-name\">:</span> libjpeg 9d <span class=\"token builtin class-name\">:</span> libpng <span class=\"token number\">1.6</span>.37 <span class=\"token builtin class-name\">:</span> libtiff <span class=\"token number\">4.1</span>.0 <span class=\"token builtin class-name\">:</span> zlib <span class=\"token number\">1.2</span>.11 <span class=\"token builtin class-name\">:</span> libwebp <span class=\"token number\">1.1</span>.0 <span class=\"token builtin class-name\">:</span> libopenjp2 <span class=\"token number\">2.3</span>.1\nFound AVX2\nFound AVX\nFound FMA\nFound SSE\n\n$ pip <span class=\"token function\">install</span> pytesseract\n\n$ pip show pytesseract\nName: pytesseract\nVersion: <span class=\"token number\">0.3</span>.3\nSummary: Python-tesseract is a python wrapper <span class=\"token keyword\">for</span> Google<span class=\"token punctuation\">\\</span>'s Tesseract-OCR\nHome-page: https://github.com/madmaze/pytesseract\nAuthor: Samuel Hoffstaetter\nAuthor-email: samuel@hoffstaetter.com\nLicense: Apache License <span class=\"token number\">2.0</span>\nLocation: /Users/whitexozu/opt/anaconda3/envs/py35/lib/python3.5/site-packages\nRequires: Pillow</code></pre></div>\n</li>\n</ul>\n<h3 id=\"tessdata-다운로드\" style=\"position:relative;\"><a href=\"#tessdata-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C\" aria-label=\"tessdata 다운로드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tessdata 다운로드</h3>\n<ul>\n<li><code class=\"language-text\">https://github.com/tesseract-ocr/tessdata</code>에서 tessdata를 다운받은후 <code class=\"language-text\">/usr/local/Cellar/tesseract/4.1.1/share/tessdata</code>에 kor.tessdata를 복사합니다.</li>\n</ul>\n<p><strong>Note:</strong><br />\ntesseract 4.1.1을 설치했는데 trainedata를 기본 경로가<br />\n<em>/usr/local/Cellar/tesseract-lang/4.0.0/share/tessdata</em>를 바라보고 있습니다.<br />\n그리고 당연하게 파일을 못 읽는다는 오류가 납니다. 오류 메시지는 아래과 같습니다.<br />\n<br />\n<code class=\"language-text\">\"Error: Tesseract (legacy) engine requested, but components are not present in /usr/local/share/tessdata/kor.traineddata!! Failed loading language 'kor' Tesseract couldn't load any languages! Could not initialize tesseract.\"</code><br />\n<br />\n<em>tessdata 다운로드</em> 를 참고하여 파일을 받았다면 경로를 변경하면 됩니다. 경로를 설정하는 방법은 두가지가 있습니다. 첫번째는 <code class=\"language-text\">--tessdata-dir</code> 옵션을 사용하는 것이고 두번째는 <code class=\"language-text\">.bash_profile</code> 또는 <code class=\"language-text\">.zprofile</code>에 경로 정보를 export 하면 됩니다.<br />\nexport TESSDATA_PREFIX=“/usr/local/Cellar/tesseract/4.1.1/share/tessdata”\n{: .notice—info}</p>\n<h2 id=\"실행\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89\" aria-label=\"실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행</h2>\n<p>두가지 방식으로 실행이 가능합니다.</p>\n<h3 id=\"명렁어-입력-실행\" style=\"position:relative;\"><a href=\"#%EB%AA%85%EB%A0%81%EC%96%B4-%EC%9E%85%EB%A0%A5-%EC%8B%A4%ED%96%89\" aria-label=\"명렁어 입력 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>명렁어 입력 실행</h3>\n<ul>\n<li>\n<p>설치된 텍서렉트에 명령어를 직접 입력하여 실행하는 방식</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ tesseract ~/Pictures/text_image/itemText.png stdout -l kor --oem <span class=\"token number\">1</span> --psm <span class=\"token number\">3</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"pytesseract-실행\" style=\"position:relative;\"><a href=\"#pytesseract-%EC%8B%A4%ED%96%89\" aria-label=\"pytesseract 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pytesseract 실행</h3>\n<ul>\n<li>\n<p>python 에서 실행</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> cv2\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> pytesseract\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n\nimPath <span class=\"token operator\">=</span> <span class=\"token string\">'itemText.png'</span>\n\nconfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'-l eng --oem 1 --psm 3'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Read image from disk</span>\nim <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>imPath<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>IMREAD_COLOR<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Run tesseract OCR on image</span>\ntext <span class=\"token operator\">=</span> pytesseract<span class=\"token punctuation\">.</span>image_to_string<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> config<span class=\"token operator\">=</span>config<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Print recognized text</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ python tesseract_test.py</code></pre></div>\n</li>\n</ul>\n<h2 id=\"옵션-설명\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%98-%EC%84%A4%EB%AA%85\" aria-label=\"옵션 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵션 설명</h2>\n<ul>\n<li><code class=\"language-text\">-stdout / output</code> : 화면 출력, 파일 출력</li>\n<li><code class=\"language-text\">-L</code> : 언어 선택</li>\n<li>\n<p><code class=\"language-text\">--oem</code> : OCR Engine Mode</p>\n<ul>\n<li>0: Legacy engine only.</li>\n<li>1: Neural nets LSTM engine only.</li>\n<li>2: Legacy + LSTM engines.</li>\n<li>3: Default, based on what is available.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">--psm</code> : PSM은 텍스트 구조에 대한 추가 정보 선택</li>\n<li><code class=\"language-text\">--tessdata-dir</code> : tessdata file path 지정</li>\n</ul>\n<h2 id=\"참고-사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고 사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고 사이트</h2>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">https<span class=\"token punctuation\">:</span>//github.com/tesseract<span class=\"token punctuation\">-</span>ocr/tessdata\nhttps<span class=\"token punctuation\">:</span>//tariat.tistory.com/703\nhttps<span class=\"token punctuation\">:</span>//m.blog.naver.com/tommybee/221307497468</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%ED%99%98%EA%B2%BD\">환경</a></li>\n<li>\n<p><a href=\"#%EC%84%A4%EC%B9%98\">설치</a></p>\n<ul>\n<li><a href=\"#tesseract-%EC%84%A4%EC%B9%98\">tesseract 설치</a></li>\n<li><a href=\"#tessdata-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C\">tessdata 다운로드</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%ED%96%89\">실행</a></p>\n<ul>\n<li><a href=\"#%EB%AA%85%EB%A0%81%EC%96%B4-%EC%9E%85%EB%A0%A5-%EC%8B%A4%ED%96%89\">명렁어 입력 실행</a></li>\n<li><a href=\"#pytesseract-%EC%8B%A4%ED%96%89\">pytesseract 실행</a></li>\n</ul>\n</li>\n<li><a href=\"#%EC%98%B5%EC%85%98-%EC%84%A4%EB%AA%85\">옵션 설명</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고 사이트</a></li>\n</ul>\n</div>","frontmatter":{"date":"March 26, 2020","title":"[Python] Mac tesseract 설치 및 실행","categories":"language","author":"TMM","emoji":null},"fields":{"slug":"/2020-03-26-language-python-tesseract/"}},"prev":{"id":"28d2b35c-3a71-57e4-ab8b-512ead08b9fc","html":"<p>많이 늦었지만 JPA를 써볼려고 합니다.</p>\n<h3 id=\"개발-환경\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD\" aria-label=\"개발 환경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발 환경</h3>\n<p>gradle + lombok + mysql + jpa</p>\n<h3 id=\"dependency-추가\" style=\"position:relative;\"><a href=\"#dependency-%EC%B6%94%EA%B0%80\" aria-label=\"dependency 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>dependency 추가</h3>\n<p>dependencies {\nimplementation ‘org.springframework.boot:spring-boot-starter-data-jpa’\nimplementation ‘org.springframework.boot:spring-boot-starter-oauth2-client’\nimplementation ‘org.springframework.boot:spring-boot-starter-security’\nimplementation ‘org.springframework.boot:spring-boot-starter-thymeleaf’\nimplementation ‘org.springframework.boot:spring-boot-starter-web’\ncompileOnly ‘org.projectlombok:lombok’\ndevelopmentOnly ‘org.springframework.boot:spring-boot-devtools’\nruntimeOnly ‘mysql:mysql-connector-java’\nannotationProcessor ‘org.projectlombok:lombok’\ntestImplementation ‘org.springframework.boot:spring-boot-starter-test’\ntestImplementation ‘org.springframework.security:spring-security-test’\n}</p>\n<h3 id=\"applicationyml-수정\" style=\"position:relative;\"><a href=\"#applicationyml-%EC%88%98%EC%A0%95\" aria-label=\"applicationyml 수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>application.yml 수정</h3>\n<h3 id=\"entity-생성\" style=\"position:relative;\"><a href=\"#entity-%EC%83%9D%EC%84%B1\" aria-label=\"entity 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Entity 생성</h3>\n<h3 id=\"repository-생성\" style=\"position:relative;\"><a href=\"#repository-%EC%83%9D%EC%84%B1\" aria-label=\"repository 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Repository 생성</h3>\n<h3 id=\"contorller-service-생성\" style=\"position:relative;\"><a href=\"#contorller-service-%EC%83%9D%EC%84%B1\" aria-label=\"contorller service 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contorller, Service 생성</h3>\n<h3 id=\"column-옵션\" style=\"position:relative;\"><a href=\"#column-%EC%98%B5%EC%85%98\" aria-label=\"column 옵션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Column 옵션</h3>\n<h3 id=\"참고사이트\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고사이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고사이트</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">https<span class=\"token punctuation\">:</span>//velog.io/@junwoo4690/Spring<span class=\"token punctuation\">-</span>Boot<span class=\"token punctuation\">-</span>JPA<span class=\"token punctuation\">-</span>%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0<span class=\"token punctuation\">-</span>erjpw41nl7\nhttps<span class=\"token punctuation\">:</span>//blog.woniper.net/255<span class=\"token punctuation\">?</span>category=531455\nhttps<span class=\"token punctuation\">:</span>//joont92.github.io/jpa/%EC%97%94%ED%8B%B0%ED%8B%B0<span class=\"token punctuation\">-</span>%EA%B0%92%EC%9D%84<span class=\"token punctuation\">-</span>%EB%B3%80%ED%99%98%ED%95%B4%EC%84%9C<span class=\"token punctuation\">-</span>%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0<span class=\"token punctuation\">-</span>Converter/\n<span class=\"token key atrule\">언더바</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//sunpil.tistory.com/302\n\nhttps<span class=\"token punctuation\">:</span>//galid1.tistory.com/531\nhttps<span class=\"token punctuation\">:</span>//goddaehee.tistory.com/95</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD\">개발 환경</a></li>\n<li><a href=\"#dependency-%EC%B6%94%EA%B0%80\">dependency 추가</a></li>\n<li><a href=\"#applicationyml-%EC%88%98%EC%A0%95\">application.yml 수정</a></li>\n<li><a href=\"#entity-%EC%83%9D%EC%84%B1\">Entity 생성</a></li>\n<li><a href=\"#repository-%EC%83%9D%EC%84%B1\">Repository 생성</a></li>\n<li><a href=\"#contorller-service-%EC%83%9D%EC%84%B1\">Contorller, Service 생성</a></li>\n<li><a href=\"#column-%EC%98%B5%EC%85%98\">Column 옵션</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고사이트</a></li>\n</ul>\n</div>","frontmatter":{"date":"April 10, 2020","title":"[JPA] Springboot + JPA + MySql","categories":"Framework","author":"TMM","emoji":null},"fields":{"slug":"/2020-04-10-framework-springboot-jpa/"}},"site":{"siteMetadata":{"siteUrl":"https://whitexozu.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/2020-03-26-language-python-macro-find-image/","nextSlug":"/2020-03-26-language-python-tesseract/","prevSlug":"/2020-04-10-framework-springboot-jpa/"}},"staticQueryHashes":["1073350324","2938748437"]}